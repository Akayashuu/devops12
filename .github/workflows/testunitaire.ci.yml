name: Run Unit Tests

on: [push, pull_request]

jobs: 
    test:
        runs-on: ubuntu-latest
        steps:
          - name: Checkout repository
            uses: actions/checkout@v2
          - name: Set up Node.js
            uses: actions/setup-node@v2
            with:
                node-version: '20'
          - name: Install dependencies
            run: npm install
          - name: Run unit tests
            run: npm test
          - name: Upload test results
            if: success()
            uses: actions/upload-artifact@v4
            with:
                  name: test-results
                  path: test-results
          - name: Create test status badge
            run: |
              if [ ${{ job.status }} == 'success' ]; then
                echo "![Tests](https://img.shields.io/badge/tests-passing-brightgreen)" > test-status.md
              else
                echo "![Tests](https://img.shields.io/badge/tests-failing-red)" > test-status.md
          - name: Upload test status badge
            uses: actions/upload-artifact@v4
            with:
                name: test-status
                path: test-status.md